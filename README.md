# Telegram Post Automation

Сервис автоматизирует перенос публикаций из канала-источника в собственный канал Telegram.

## Возможности

- Опрос канала-источника через Bot API с фильтрацией по ID автора.
- Адаптация текста постов через DeepSeek API с ретраями.
- Автоматическое добавление эмодзи, хештегов и промо-ссылок на биржи OKX/Binance.
- Публикация подготовленных постов в ваш канал от имени бота.
- CLI на базе Typer с командами `poll-once` и `run-loop`.

## Требования

- Python 3.11+
- Установленные зависимости:

```bash
pip install -r requirements.txt
```

## Переменные окружения

| Переменная               | Описание                                   |
|--------------------------|---------------------------------------------|
| `DEEPSEEK_APPI`          | API-ключ DeepSeek                           |
| `USERNAMETELERGRAMBOT`   | Юзернейм бота (например, `@my_bot`)         |
| `TELEGRAMKEY`            | Токен Telegram Bot API                      |
| `TELEGRAMKANAL`          | ID/юзернейм канала для публикации постов    |
| `TGUSERID`               | ID канала-источника (значение `sender_chat`)|

Создайте файл `.env` или экспортируйте переменные в окружение перед запуском.

## Быстрый старт

Создайте и активируйте виртуальное окружение, затем установите зависимости:

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## Запуск

Однократная обработка новых сообщений:

```bash
PYTHONPATH=src python -m telegram_post.main poll-once
```

Непрерывный цикл опроса (по умолчанию с интервалом 60 секунд):

```bash
PYTHONPATH=src python -m telegram_post.main run-loop --interval 120
```

## Тестирование

Для проверки сценариев работы `TelegramClient` выполните:

```bash
PYTHONPATH=src python -m pytest -q
```

## Логирование и ошибки

Логи выводятся в стандартный поток в текстовом формате. При отсутствии обязательных
переменных окружения приложение завершится с понятным сообщением.

## Разработка

- Код форматируется `black`, линтер — `ruff` (добавьте при необходимости).
- Точки расширения: интеграция persistent-хранилища для `update_id`, дополнительные биржи.
